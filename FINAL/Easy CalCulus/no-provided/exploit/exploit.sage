from minipwn import * # https://github.com/oalieno/mini-pwntools
from time import sleep

host = "127.0.0.1"
port = 32784

proc = remote(host, port)

def recv(limit : bytes):
    global proc
    received = proc.recvuntil(limit)
    print("<")
    print(received.decode())
    return received.decode()

def send(msg : bytes):
    global proc
    print(">")
    print(msg.decode())
    proc.sendline(msg)


resp = recv(b"\n")

hint = resp.split("test: ")[1].splitlines()[0]

# proc.recvlines()

p = 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F
a = 0x0000000000000000000000000000000000000000000000000000000000000000
b = 0x0000000000000000000000000000000000000000000000000000000000000007

curve = EllipticCurve(GF(p), [a, b])

G = curve((65485170049033141755572552932091555440395722142984193594072873483228125624049, 73163377763031141032501259779738441094247887834941211187427503803434828368457))

solution = G.order() + int(hint, 16)


print(proc.recvlines(1))

send(str(solution).encode())
print(proc.recvlines(2))
